---
title: "ENVS-193DS_final"
author: Adrianna Martinez
date: "2025-06-11"
format:
  html:
    toc: true
    toc-float: true
    code-float: true
---

[View the GitHub repository](https://github.com/madrianna03/ENVS-193DS_spring-2025_final.git)

```{r}
# Load packages
library(tidyverse)    # for data wrangling and visualization
library(lubridate)    # for working with dates
library(here)         # for file paths
library(knitr)        # for tables
library(DHARMa)       # for model diagnostics
library(MuMIn)        # for AIC model selection
library(broom)        # for model outputs
library(ggeffects)    # for model predictions and plotting

# Read in datasets
# Sea surface temperature data for Problem 2
sst <- read_csv(here("data", "SST_update2023.csv"))

# Nest box occupancy data for Problem 3
nest_boxes <- read_csv(here("data", "occdist.csv"))

```

## Problem 1: Research Writing

a.  Transparent statistical methods

In part 1, the coworker used a Pearson's correlation coefficient test to examine the relationship between distance from headwater (km) and annual total nitrogen load (kg year^-1^). In part 2, they used a one-way ANOVA to test for differences in average nitrogen load (kg year^-1^) between the five different sources.

b. More information needed

They could include descriptive statistics (mean ± SD) for each source to understand the magnitude and variability in nitrogen load across sources. Including the mean and standard deviation of nitrogen load for each source gives readers biological context, not just statistical significance, and supports interpretation of the ANOVA result.

Including effect size measures such as eta-squared or omega-squared would help the reader to understand the practical significance of these differences. Effect size tells us what proportion of the variance in nitrogen load is explained by source type, helping us to understand the magnitude of this effect in biological terms. 

c. Suggestions for rewriting

Part 1: Distance from headwater showed a significant correlation with annual total nitrogen load, with sites farther from headwater sources associated with different nitrogen loading patterns (correlation test: r = [correlation coefficient], df = [degrees of freedom], p = 0.03, α = [significance level]).

Part 2: Nitrogen sources differed significantly in their average annual nitrogen load contributions to the San Joaquin River Delta, with some sources contributing substantially more than others (one-way ANOVA: F = [F-statistic], df = [degrees of freedom], p = 0.02, α = [significance level]). Post-hoc analyses revealed that [specific source types] contributed significantly more nitrogen load than [other source types] ([post-hoc test]: [test statistics and p-values for significant comparisons]).

## Part 2: Data Visualization

a. Clean and summarize

```{r}
# Create sst_clean object with data cleaning and summarizing
sst_clean <- sst |> 
  # Convert date column to proper date format
 mutate(date = ymd(date)) |> 
  # Extract year and month from date
 mutate(year = year(date),
         month = month(date, label = TRUE, abbr = TRUE)) |> 
  # Filter for years 2018-2023 only
 filter(year >= 2018 & year <= 2023) |> 
  # Group by year and month to calculate monthly means
 group_by(year, month) |> 
  # Calculate mean monthly sea surface temperature
 summarise(mean_monthly_sst = mean(temp, na.rm = TRUE), .groups = "drop") |> 
  # Convert year to factor for proper ordering and visualization
 mutate(year = as.factor(year)) |> 
  # Arrange by year and month for proper ordering
 arrange(year, month)

# Display 5 random rows from sst_clean
set.seed(123) # for reproducibility
sst_clean |> 
  slice_sample(n = 5)

# Display structure of sst_clean
str(sst_clean)

```

b. Visualize the data

```{r}
# Create the visualization matching the target figure
ggplot(sst_clean, aes(x = month, y = mean_monthly_sst, group = year, color = year)) +
  # Add line geometry connecting points by year
  geom_line(size = 1) +
  # Add point geometry for individual data points
  geom_point(size = 2) +
  # Set up color gradient from light to dark blue for 2018-2023
  scale_color_manual(values = c("2018" = "#87CEEB",  # light blue
                               "2019" = "#6BB6FF",  # 
                               "2020" = "#4682B4",  # 
                               "2021" = "#1E90FF",  # 
                               "2022" = "#0000CD",  # 
                               "2023" = "#000080")) + # dark blue
  # Set y-axis limits and breaks to match the figure
  scale_y_continuous(limits = c(12, 20), 
                     breaks = seq(12, 20, by = 2)) +
  # Customize axis labels and legend
  labs(x = "Month",
       y = "Mean monthly sea surface temperature (°C)",
       color = "Year") +
  # Match the theme and styling of the target figure
  theme_classic() +
  theme(
    # Add panel border (box around plot area)
    panel.border = element_rect(color = "black", fill = NA, linewidth = 0.8),
    # White panel background
    panel.background = element_rect(fill = "white", color = NA),
    # Position legend inside plot area (top left)
    legend.position = c(0.15, 0.85),
    legend.background = element_rect(fill = "white", color = NA),
    legend.title = element_text(size = 12, face = "bold"),
    legend.text = element_text(size = 10),
    # Customize axis text and titles
    axis.text = element_text(size = 11, color = "black"),
    axis.title = element_text(size = 12, color = "black"),
    axis.title.x = element_text(margin = margin(t = 10)),
    axis.title.y = element_text(margin = margin(r = 10)),
    # Ensure complete axis box
    axis.line = element_blank()
  )
```


## Part 3: Data Analysis

a. Response variable

The 1s and 0s in this dataset represent Swift Parrot nest box occupancy, where 1 indicates that a nest box was occupied by Swift Parrots for breeding, and 0 indicates that the box was either unoccupied or occupied by competitor species (Common Starlings or Tree Martins).

b. Purpose of study

Swift Parrots are critically endangered native birds that require conservation assistance, while Common Starlings and Tree Martins are either introduced species (starlings) or native competitors that can outcompete Swift Parrots for limited nesting sites. The study aims to understand whether nest boxes intended for Swift Parrot conservation are actually being used by the target species or by their competitors.

c. Difference in "seasons"

The two seasons are 2016 and 2019, representing early deployment (2016) when nest boxes were newly installed, and a follow-up assessment (2019) after three years had elapsed. This comparison allows researchers to understand how nest box occupancy patterns change over time as both target and competitor species become familiar with the artificial nesting sites.

## d. Table of models
